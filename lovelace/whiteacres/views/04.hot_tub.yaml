title: Hot Tub
path: hottub
icon: 'mdi:hot-tub'
badges: []
cards:
  - type: 'custom:button-card'
    aspect_ratio: 1/1
    custom_fields:
      readyby:
        card:
          type: conditional
          conditions:
            - entity: input_boolean.hottub_scheduled
              state: "on"
          card:
            type: entity
            entity: input_datetime.hottub_ready_by
            name: Ready By
            style: |
              ha-card {
                box-shadow: none;
              }
          tap_action:
            action: call-service
            service: script.turn_on
            service_data:
              entity_id: script.hottub_readyby_tap
          double_tap_action:
            action: call-service
            service: script.turn_on
            service_data:
              entity_id: script.hottub_readby_double_tap
      graph:
        card:
          type: sensor
          entity: sensor.hottub_water_temp
          name: Hot Tub
          graph: line
          style: |
            ha-card {
              box-shadow: none;
            }
    styles:
      custom_fields:
        graph:
          - filter: opacity(75%)
          - overflow: unset
      card: null
      grid:
        - grid-template-areas: '"i" "n" "readyby" "graph"'
        - grid-template-columns: 1fr
        - grid-template-rows: 1fr min-content min-content
    entity: sensor.hottub_summary
    show_name: false
    icon: 'mdi:help'
    tap_action:
      action: call-service
      service: script.turn_on
      service_data:
        entity_id: script.hottub_card_tap
    double_tap_action:
      action: call-service
      service: script.turn_on
      service_data:
        entity_id: script.hottub_card_double_tap
    state:
      - value: offline
        icon: 'mdi:access-point-off'
        color: red
      - value: filtering
        icon: 'mdi:air-filter'
        color: red      
      - value: circulating
        icon: 'mdi:water-pump'
        color: blue           
      - value: 'off'
        icon: 'mdi:power'
        color: red
      - value: scheduled
        icon: 'mdi:clock'
        color: orange
      - value: heating
        icon: 'mdi:fire'
        color: red

  - entities:
      - entity: climate.spa_climate
        name: Spa
      - entity: input_number.hottub_water_target
        name: Immediate Target Temperature      
      - entity: input_number.hottub_standard_temp
        name: Standard Target Temperature          
      - entity: binary_sensor.spa_circ_pump
        name: Circulation Pump
      - entity: binary_sensor.spa_filter1
        name: Filter Pump
#      - entity: binary_sensor.spa_filter2
#        name: Filter 2        
      - entity: fan.spa_pump1
        name: Jets 1
      - entity: fan.spa_pump2
        name: Jets 2      
      - entity: switch.spa_light1
        name: Lights
      - entity: switch.spa_temp_range
        name: High Temp Range
      - entity: input_datetime.hottub_ready_by
        name: Ready by
      - entity: sensor.hottub_summary
        name: Status
      - entity: input_boolean.hottub_scheduled
        name: Schedule on
      - entity: sensor.hottub_price
        name: Price per Hour
      - entity: input_number.hottub_heat_below_x_pence
        name: Heat below x pence
      - entity: sensor.hottub_heating_this_week
        name: Heating Time This Week
    show_header_toggle: false
    title: Hot Tub
    type: entities
    state_color: true
  - icon: 'mdi:menu'
    show_icon: true
    show_name: false
    styles:
      card:
        - height: 90px
    tap_action:
      action: navigate
      haptic: success
      navigation_path: /lovelace-switchboard/menu
    type: 'custom:button-card'
  - type: logbook
    entities:
      - sensor.hottub_summary
hours_to_show: 24